---
title: "Assignment 5 -- Brad Stenger"
---

### 1. Prove that if $X$ is a Gaussian random variable with zero mean and unit variance then $Y=X^2$ is a Chi-square random variable.

$$
\begin{aligned}
\mathrm{for \ } y < 0 \mathrm{\ the \ CDF}, F_Y(y) = P(Y < y) = 0 \\
\mathrm{for \ } y >= 0 \mathrm{\ the \ CDF},  F_Y(y) = P(Y < y) = P(X^2 < y) = P(|X| < \sqrt{y}) = P(-\sqrt{y} < X < \sqrt{y}) \\
 = F_X(\sqrt{y}) - F_X(-\sqrt{-y}) = F_X(\sqrt{y}) - (1 - F_X(\sqrt{y})) = 2F_X(\sqrt{y}) - 1 \\
\mathrm{PDF}, f_Y(y) = \frac{d}{dy}F_Y(y) = 2 \frac{d}{dy}F_X(\sqrt{y}) - 0 \\
\mathrm{density \ function \ } F_X(\sqrt{y}) = \int_{-\infty}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{\frac{-u^2}{2}} du \\
f_Y(y) = 2 \frac{d}{dy} \int_{-\infty}^{\sqrt{y}} \frac{1}{\sqrt{2\pi}} e^{\frac{-u^2}{2}} du \\
 = 2 \frac{1}{\sqrt{2\pi}} e^{-\frac{y}{2}} (\frac{1}{2}y^{-\frac{1}{2}}) \\
 \Gamma(\frac{1}{2}) = \sqrt{\pi} \\
\mathrm{Chi\ square: \ } f_Y(y) = \frac{1}{2^{\frac{1}{2}}\Gamma(\frac{1}{2})} y^{-\frac{1}{2}} e^{-\frac{y}{2}}
\end{aligned}
$$


### 2. If $X$ is a uniform random variable in the interval $[0,2\pi]$, what is the probability distribution of:

#### a. $Y = X + 1$

$$
\begin{aligned}
\mathrm{Y\ interval: \ } 0 + 1 <= X + 1 <= 2\pi + 1 \\
 1 <= Y <= 2\pi + 1 \\
\mathrm{CDF,\ X:\ } F_X(x) = \int_{0}^{x}\frac{1}{2\pi}du = \frac{x}{2\pi} \\
\mathrm{CDF,\ Y:\ } F_Y(y) = F_X(y-1) = \frac{y-1}{2\pi} \mathrm{\ for\ } 1 <= y <= 2\pi + 1 \\
\mathrm{PDF,\ Y:\ } f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}(\frac{y-1}{2\pi}) = \frac{1}{2\pi} \mathrm{\ for\ } 1 <= y <= 2\pi + 1
\end{aligned}
$$

```{r}
n_samples <- 1000
X <- runif(n_samples, min = 0, max = 2 * pi)
Y <- X + 1
plot(X,Y, cex=0.25, col="gray")
par(new=T)
plot(seq(0,2*pi, length.out=n_samples), rep(1/2*pi, times=n_samples), cex=0.25)
par(new=T)
plot(rep(1/2*pi, times=n_samples), seq(1, 1+2*pi, length.out=n_samples), cex=0.25, col="red")
```

#### b. $Y = X^2$

$$
\begin{aligned}
\mathrm{Y\ interval: \ } 0 <= X^2 <= (2\pi)^2 \\
0 <= Y <= 4\pi^2 \\
\mathrm{CDF,\ X:\ } F_X(x) = \int_{0}^{x}\frac{1}{2\pi}du = \frac{x}{2\pi} \\
\mathrm{CDF,\ Y:\ } F_Y(y) = F_X(\sqrt{y}) = \frac{\sqrt{y}}{2\pi} \mathrm{\ for\ } 0 <= y <= 4\pi^2 \\
\mathrm{PDF,\ Y:\ } f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}(\frac{\sqrt{y}}{2\pi}) \\
 = \frac{1}{2\pi} \frac{d}{dy}y^{\frac{1}{2}} \\
 = \frac{1}{2\pi} \frac{1}{2} y^{-\frac{1}{2}} \\
 = \frac{1}{4\pi\sqrt{y}} \mathrm{\ for\ } 1 <= y <= 2\pi + 1
\end{aligned}
$$

```{r}
n_samples <- 1000
X <- runif(n_samples, min = 0, max = 2 * pi)
Y <- X^2
plot(X,Y, cex=0.25, xlim=c(-2*pi,2*pi), ylim=c(0,4*pi*pi), col="gray")
par(new=T)
x <- seq(0,2*pi, length.out=n_samples)
plot(x, x/(2*pi), xlim=c(-2*pi,2*pi), ylim=c(0,4*pi*pi), cex=0.25)
par(new=T)
y <- seq(0, 4*pi*pi, length.out=n_samples)
plot(1/(4*pi*sqrt(y)), y, xlim=c(-2*pi,2*pi), ylim=c(0,4*pi*pi), cex=0.25, col="red")
```

#### c. $Y = sinX$

$$
\begin{aligned}
\mathrm{Y\ interval: \ } [-1,1] \\
\mathrm{CDF,\ X:\ } F_X(x) = \int_{0}^{x}\frac{1}{2\pi}du = \frac{x}{2\pi} \\
\mathrm{CDF,\ Y:\ } F_Y(y) = P(X \in [0,arcsin(y) or X \in [\pi - arcsin(y), 2\pi] ]) \\
 = \frac{1}{2\pi}((arcsin(y) - 0) + (2\pi - (\pi - arcsin(y)))) \\
 = \frac{1}{2\pi}(2 arcsin(y) + \pi) \\
 = \frac{1}{2} + \frac{arcsin(y)}{\pi} \mathrm{\ for\ } -1 <= y <= 1 \\
\mathrm{PDF,\ Y:\ } f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}(\frac{1}{2} + \frac{arcsin(y)}{\pi}) \\
 = \frac{1}{\pi} \frac{d}{dy}(arcsin(y)) \\
 = \frac{1}{\pi\sqrt{1-y^2}} \mathrm{\ for\ } -1 <= y <= 1
\end{aligned}
$$

```{r}
n_samples = 1000
X <- runif(n_samples, min = 0, max = 2 * pi)
Y <- sin(X)
plot(X,Y, cex=0.25, xlim=c(-2*pi,2*pi), ylim=c(-1.5,1.5), col="gray")
par(new=T)
x <- seq(0,2*pi, length.out=n_samples)
plot(x, x/(2*pi), xlim=c(-2*pi,2*pi), ylim=c(-1.5, 1.5), cex=0.25)
par(new=T)
y <- seq(-1, 1, length.out=n_samples)
plot(1/(pi*sqrt(1-y^2)), y, xlim=c(-2*pi,2*pi), ylim=c(-1.5, 1.5), cex=0.25, col="red")
```

### 3. If X is an exponential random variable with parameter $\lambda = 1$, what is the probability distribution of: 

#### a. $Y = X + 1$

$$
\begin{aligned}
\mathrm{CDF,\ X:\ } F_X(x) = P(X <= x) = 1 - e^{-x} \\
\mathrm{CDF,\ Y:\ } F_Y(y) = F_X(y-1) = 1 - e^{-(y-1)} \mathrm{\ for\ } y >= 1 \\
\mathrm{PDF,\ Y:\ } f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}(1 - e^{-(y-1)}) \\
 = -(-1)e^{-(y-1)} \\
 = e^{-(y-1)} \mathrm{\ for\ } y >= 1
\end{aligned}
$$

```{r}
n_samples = 1000
X <- rexp(n_samples, 1)
Y <- X + 1
plot(X,Y, xlim=c(0,10), ylim=c(0,10), cex=0.25, col="gray")
par(new=T)
x <- seq(0, 10, length.out=n_samples)
plot(x, 1 - exp(-x), xlim=c(0,10), ylim=c(0,10), cex=0.25)
par(new=T)
y <- seq(1,10, length.out=n_samples)
plot(1-exp(-(y-1)), y, xlim=c(0,10), ylim=c(0,10), cex=0.25, col="red")
```

#### b. $Y = X^2$

$$
\begin{aligned}
\mathrm{CDF,\ X:\ } F_X(x) = P(X <= x) = 1 - e^{-x} \\
\mathrm{CDF,\ Y:\ } F_Y(y) = F_X(\sqrt{y}) = 1 - e^{-\sqrt{y}} \mathrm{\ for\ } y >= 0 \\
\mathrm{PDF,\ Y:\ } f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}(1 - e^{-\sqrt{y}}) \\
\mathrm{chain\ rule:\ } \frac{d}{du}e^u = e^u * u' \mathrm{\ where\ } u = -\sqrt{y} \\
f_Y(y) = -e^{-\sqrt{y}} \frac{d}{dy}(-\sqrt{y}) \\
 = -e^{-\sqrt{y}} (- \frac{1}{2\sqrt{y}}) \\
 = \frac{1}{2\sqrt{y}} e^{-\sqrt{y}} \mathrm{\ for\ } y >= 0
\end{aligned}
$$

```{r}
n_samples = 1000
X <- rexp(n_samples, 1)
Y <- X^2
plot(X,Y, xlim=c(0,10), ylim=c(0,10), cex=0.25, col="gray")
par(new=T)
x <- seq(0, 10, length.out=n_samples)
plot(x, 1 - exp(-x), xlim=c(0,10), ylim=c(0,10), cex=0.25)
par(new=T)
y <- seq(1,10, length.out=n_samples)
plot((1/(2*sqrt(y)))*exp(-(y-1)), y, xlim=c(0,10), ylim=c(0,10), cex=0.25, col="red")
```

#### c. $Y = X^3$

$$
\begin{aligned}
\mathrm{CDF,\ X:\ } F_X(x) = P(X <= x) = 1 - e^{-x} \\
\mathrm{CDF,\ Y:\ } F_Y(y) = F_X(y^{\frac{1}{3}}) = 1 - e^{-y^{\frac{1}{3}}} \mathrm{\ for\ } y >= 0 \\
\mathrm{PDF,\ Y:\ } f_Y(y) = \frac{d}{dy}F_Y(y) = \frac{d}{dy}(1 - e^{-y^{\frac{1}{3}}}) \\
 = -e^{-y^{\frac{1}{3}}} \frac{d}{dy}(-y^{\frac{1}{3}}) \\
 = -e^{-y^{\frac{1}{3}}} (- \frac{1}{3}) y^{-\frac{2}{3}} \\
 = \frac{1}{3} y^{-\frac{2}{3}} e^{-y^{\frac{1}{3}}} \mathrm{\ for\ } y >= 0
\end{aligned}
$$

```{r}
n_samples = 1000
X <- rexp(n_samples, 1)
Y <- X^3
plot(X,Y, xlim=c(0,10), ylim=c(0,10), cex=0.25, col="gray")
par(new=T)
x <- seq(0, 10, length.out=n_samples)
plot(x, 1 - exp(-x), xlim=c(0,10), ylim=c(0,10), cex=0.25)
par(new=T)
y <- seq(1,10, length.out=n_samples)
plot((1/3)*(y^(-2/3))*exp(-y^(1/3)), y, xlim=c(0,10), ylim=c(0,10), cex=0.25, col="red")
```

### 4. If $X$ is a Gaussian random variable with zero mean and unit variance, what is the probability distribution of:

### $Y = e^X$

$$
\begin{aligned}
\mathrm{PDF,\ X:\ } f_X(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \\
\mathrm{Inverse\ X:\ } X = ln(Y) \\
\mathrm{PDF,\ Y:\ } f_Y(y) = f_X(ln(y)) \frac{d}{dy}ln(y) \\
 = f_X(ln(y)) \frac{1}{y} \\
 = \frac{1}{y \sqrt{2\pi}} e^{-\frac{(ln(y))^2}{2}} \mathrm{\ for\ } y >= 0
\end{aligned}
$$

```{r}
curve(dnorm(x, 0, 1), -4, 4, ylim=c(0,4))
Y <- seq(-4, 4, length.out=10000)
meanlog <- 0
sdlog <- 1
par(new=TRUE)
plot((1 / (Y * sdlog * sqrt(2 * pi))) * exp(-((log(Y) - meanlog)^2 / (2 * sdlog^2))), 
     Y,
     xlim=c(-4,4), 
     ylim=c(0,4), 
     cex=0.1, 
     col="gray")
par(new=TRUE)
plot(dlnorm(Y, meanlog=0, sdlog = 1), Y, xlim=c(-4,4), ylim=c(0,4), cex=0.1, col="red")
```

#### 2. $Y = e^{-X}$

$$
\begin{aligned}
\mathrm{PDF,\ X:\ } f_X(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}} \\
\mathrm{Inverse\ X:\ } X = -ln(Y) \\
\mathrm{PDF,\ Y:\ } f_Y(y) = f_X(-ln(y)) \frac{d(-ln(y))}{dy} \\
 = f_X(ln(y)) (-\frac{1}{y}) \\
 = -\frac{1}{y \sqrt{2\pi}} e^{-\frac{(ln(y))^2}{2}} \mathrm{\ for\ } y >= 0
\end{aligned}
$$

```{r}
curve(dnorm(x, 0, 1), -4, 4, ylim=c(0,4))
Y <- seq(-4, 4, length.out=10000)
meanlog <- 0
sdlog <- 1
par(new=TRUE)
plot(-1*(1 / (Y * sdlog * sqrt(2 * pi))) * exp(-((log(Y) - meanlog)^2 / (2 * sdlog^2))), 
     Y,
     xlim=c(-4,4), 
     ylim=c(0,4), 
     cex=0.1, 
     col="gray")
par(new=TRUE)
plot(-1*dlnorm(Y, meanlog=0, sdlog = 1), Y, xlim=c(-4,4), ylim=c(0,4), cex=0.1, col="red")
```

#### 3. $Y = |X|$

```{r}
curve(dnorm(x, 0, 1), -4, 4, ylim=c(-0.1,4))
sd <- 1
Y <- seq(0,4, length.out=1000)
X <- (sqrt(2) / (sd * sqrt(pi))) * exp(-Y^2 / (2 * sd^2))
par(new=TRUE)
plot(X, Y, type="l", xlim=c(-4,4), ylim=c(-0.1,4), col="red")
```