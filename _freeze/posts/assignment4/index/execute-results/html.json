{
  "hash": "a95e5d8d3acb61bf693de3c2e0edd21a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 4 -- Brad Stenger\"\n---\n\n### 1. An event occurs in average once every 5 years. Compute the following probabilities:\n\n#### a. The event occurs once in any given year.\n\n1/5 matches rate, $\\lambda = 0.2$\n\n#### b. 2 events occur in a 5-year period\n\n$\\lambda = 1$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(2, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1839397\n```\n\n\n:::\n:::\n\n\n#### c. 5 events occur in a 5-year period\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(5,1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.003065662\n```\n\n\n:::\n:::\n\n\n#### d. No events occur in a 10-year period\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(0,1)*dpois(0,1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1353353\n```\n\n\n:::\n:::\n\n\n#### e. No events occur in a 20-year period\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(0,1)^4\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.01831564\n```\n\n\n:::\n:::\n\n\n#### f. 1 event occurs in a 50-year period\n\n\n::: {.cell}\n\n```{.r .cell-code}\n0.2*(dpois(0,1)^9)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 2.468196e-05\n```\n\n\n:::\n:::\n\n\n### 2. What is the probability that a 100-year flood occurs twice in one decade?\n\n$1 - p(\\mathrm{1\\ or\\ 0\\ floods\\ occur})$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - ppois(0.1, 0.01)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.009950166\n```\n\n\n:::\n:::\n\n\n### 3. The probability of occurrence (*p*) of a certain event is most likely around 0.10, but you are not sure and you estimate that it could be as low as 0.02 and as high as 0.30. If you observe 2 occurrences in 10 trials, what does that tell you about *p*. What is the probability that *p* is between 0.15 and 0.25?\n\n$\\mathrm{Beta\\ distribution\\ for\\ prior,\\ } \\mu = 0.10 = \\frac{\\alpha}{\\alpha + \\beta}$\n\n$\\beta = 0.9\\alpha \\mathrm{,\\ as\\ integers\\ } \\beta = 18 \\mathrm{\\ and\\ } \\alpha = 2$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot.new()\ncurve(dbeta(x, shape1=2, shape2=18), from=0, to=1)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nPosterior for Beta distribution\n\n$\\alpha' = 2 + 2 = 4 \\mathrm{\\ and\\ } \\beta' = 18 + 10 - 2 = 26$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot.new()\ncurve(dbeta(x, shape1=2, shape2=18), from=0, to=1)\ncurve(dbeta(x, shape1=4, shape2=26), from=0, to=1, col='red', add=TRUE)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n$\\mu' = \\frac{\\alpha'}{\\alpha' + \\beta'} = \\frac{4}{4 + 26}$\n\n\n::: {.cell}\n\n```{.r .cell-code}\nintegrate(dbeta, 0.15, 0.25, shape1=4, shape2=26)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n0.3031957 with absolute error < 3.4e-15\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx_values <- seq(0,1,length.out = 100)\nbeta_densities <- dbeta(x_values, shape1=4, shape2=26)\nplot.new()\ncurve(dbeta(x, shape1=2, shape2=18), from=0, to=1)\ncurve(dbeta(x, shape1=4, shape2=26), from=0, to=1, col='red', add=TRUE)\nshade_indices <- which(x_values >= 0.15 & x_values <= 0.25)\npolygon(c(x_values[shade_indices], rev(x_values[shade_indices])), c(beta_densities[shade_indices], rep(0, length(shade_indices))), col=\"red\", border=NA)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n### 4. Do a literature search determine the probability that 2 hurricanes category 4 or larger hit the eastern U.S. on any single year.\n\nIn 2017 Hurricane Harvey (Texas) and Hurricane Irma (Florida) made landfall in the eastern U.S.\n\nSince 2000 there have been 61 Atlantic Basin hurricanes reaching Category 4 or Category 5. Most hurricanes do not make landfall. An even smaller percentage of hurricanes that make landfall hit the U.S.\n\n| Year | Cat 4-5 | Landfall | LF USA |\n|------|---------|----------|--------|\n| 2000 | 2       | 0        | 0      |\n| 2001 | 2       | 2        | 0      |\n| 2002 | 1       | 0        | 0      |\n| 2003 | 2       | 0        | 0      |\n| 2004 | 4       | 1        | 1      |\n| 2005 | 5       | 3        | 0      |\n| 2006 | 0       | 0        | 0      |\n| 2007 | 2       | 2        | 0      |\n| 2008 | 4       | 2        | 0      |\n| 2009 | 1       | 0        | 0      |\n| 2010 | 4       | 0        | 0      |\n| 2011 | 2       | 0        | 0      |\n| 2012 | 0       | 0        | 0      |\n| 2013 | 0       | 0        | 0      |\n| 2014 | 1       | 0        | 0      |\n| 2015 | 1       | 1        | 0      |\n| 2016 | 2       | 1        | 0      |\n| 2017 | 4       | 3        | 2      |\n| 2018 | 2       | 1        | 1      |\n| 2019 | 2       | 1        | 0      |\n| 2020 | 5       | 3        | 1      |\n| 2021 | 2       | 1        | 1      |\n| 2022 | 2       | 1        | 1      |\n| 2023 | 3       | 0        | 0      |\n| 2024 | 4       | 2        | 1      |\n| 2025 | 4       | 1        | 0      |\n\n13/28 of Category 4-5 hurricanes made landfall since 2017, and 7/13 Category 4-5 hurricanes that have made landfall hit the U.S.\n\n$\\lambda = 7 \\mathrm{\\ hurricanes}/9 \\mathrm{\\ years} = 0.78$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(2,7/9)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.1389621\n```\n\n\n:::\n:::\n\n\n### 5. How many magnitude 6.0 (or larger) earthquakes have occurred in the state of California in the last 100 years. Based on this number determine the probability of seeing zero magnitude 6.0 (or larger) in a period of 20 years.\n\nAccording to https://www.conservation.ca.gov/cgs/earthquakes/big there have been 49 earthquake in or near the state of California since 1925.\n\n$\\lambda = 49 \\mathrm{\\ earthquakes}/100 \\mathrm{\\ years} = 0.49$\n\nSo, for 1 year and for 20 consecutive years\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(0, 0.49)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.6126264\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndpois(0, 0.49)^20\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 5.54516e-05\n```\n\n\n:::\n:::\n\n\n### 6. Define the PDF of a Gaussian random variable with zero mean and variance of 4 and then find the PDF of a Laplacian random variable which has the same mean and variance as the Gaussian. Plot your results and comment on their behavior close to the mean and far away from the mean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(greybox)\n```\n\n::: {.cell-output .cell-output-stderr}\n\n```\nPackage \"greybox\", v2.0.6 loaded.\n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- seq(-10,10,length.out=1000)\npdf_g <- dnorm(x, 0, 2)\nplot(x, pdf_g, type=\"l\")\nscale = sqrt(2)\npdf_l <- dlaplace(x, 0, scale)\npar(new=T)\nplot(x, pdf_l, type=\"l\", col=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n\n### 7. Generate 10 samples of a Gaussian random variable with mean 10 and variance of 4. Assume you know the mean precisely. Use Bayesian estimation to estimate its variance. Use a uniform prior between 0 and 10.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pracma)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#uniform distribution\nsigma <- seq(0,10, length.out=10)\nfl <- dunif(sigma, 0, 10)\nplot(sigma,fl,type=\"l\")\n\nvariance = 4\nsd = sqrt(variance)\nsamples <- rnorm(10, 10, sd)\nfor (sample in samples) {\n  likelihood <- (1/sqrt(2*pi*(sigma^2)))*exp(-((sample^2)/(2*(sigma^2))))\n  posterior <- likelihood * fl\n  evidence <- trapz(posterior)*0.1\n  post <- posterior/evidence\n  par(new=T)\n  plot(sigma, posterior,type=\"l\")\n  fl = posterior\n}\npar(new=T)\nplot(sigma,posterior,type=\"l\",col=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\n\n### 8. Generate 10 samples of an exponential random variable with $\\lambda = 2$. Use Bayesian estimation to estimate $\\lambda$. Use a uniform prior between 0 and 5. Compare your answer with just using basic statistics.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pracma)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#uniform distribution\nlambda <- seq(0,5, length.out=10)\nprior <- c(dunif(lambda, 0, 5)[1:5],dunif(lambda, 0, 5)[1:5])\nplot(lambda,prior,type=\"l\")\n\nrate = 2\nsamples <- rexp(10,rate)\nfor (sample in samples) {\n  likelihood <- lambda*exp(-lambda*sample)\n  evidence <- trapz(likelihood*prior)*0.2\n  posterior <- likelihood*prior/evidence\n  par(new=T)\n  plot(lambda,prior,type=\"l\", xlim=c(0,5))\n  prior <- posterior\n}\npar(new=T)\nplot(lambda,posterior,type=\"l\", xlim=c(0,5), col=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(samples)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n0.01876 0.11832 0.17124 0.26569 0.26082 1.05484 \n```\n\n\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(posterior)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n0.00000 0.02811 0.57117 0.53853 0.97659 1.19530 \n```\n\n\n:::\n:::\n\n\n### 9. Generate 10 samples of uniform random variable with $a = 0$ and $b = 1$. Assume $a$ is known, use Bayesian estimation to estimate $b$. Use a Gaussian prior for $b$ with a mean of 1.5 and variance of 0.25.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pracma)\n```\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples = runif(10)\nprior = rnorm(10, 1.5, 0.5)\na = 0\nb = max(prior)\nplot(0, b, xlim=c(0,10), ylim=c(0,4))\n\nfor (i in 1:length(samples)) {\n  likelihood <- 1/(b-a)\n  evidence <- ((1/samples[i]) + (1/(b-a)))/2\n  posterior <- likelihood*prior/evidence\n  b <- max(posterior)\n  prior <- posterior\n  par(new=T)\n  plot(i, b, xlim=c(0,10), ylim=c(0,4))\n}\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-23-1.png){width=672}\n:::\n:::\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsamples = runif(10)\nprior = rnorm(10, 1.5, 0.5)\na = 0\nb = max(prior)\nplot(0, b, xlim=c(0,10), ylim=c(0,4))\n\nfor (i in 1:length(samples)) {\n  likelihood <- 1/(b-a)\n  evidence <- ((1/samples[i]) + (1/(b-a)))/2\n  posterior <- likelihood*prior/evidence\n  b <- max(posterior)\n  prior <- posterior\n  par(new=T)\n  plot(i, b, xlim=c(0,10), ylim=c(0,4))\n}\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}